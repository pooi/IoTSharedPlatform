extends layout

block content

    include toolbar


    v-content.brown.lighten-5.animation-fade-in(style="padding-top: 50px")
        //v-container.pa-0(:fluid="$vuetify.breakpoint.xsOnly || $vuetify.breakpoint.smOnly")
        v-container.pa-0()

            v-flex(md12='')
                //v-card.pa-3.safe-area-inset(:class="$vuetify.breakpoint.xsOnly || $vuetify.breakpoint.smOnly  ? 'elevation-0 mb-4 pt-4' : 'elevation-10 my-4'")
                v-card.safe-area-inset.elevation-0.mb-4(:class="$vuetify.breakpoint.xsOnly || $vuetify.breakpoint.smOnly  ? 'pt-3 pb-0 px-0' : 'pa-3'")

                    v-card-title.pb-0(style="margin-top: 20px;")
                        span.display-2(style="font-weight: 800;") 글 작성

                    v-card-text.py-0
                        v-divider.my-3

                    v-card-text
                        v-layout
                            v-flex(xs12)
                                v-card.pa-0.elevation-4
                                    v-card-text.py-1.px-0
                                        //span.headline.red--text.text--darken-1(style="font-weight: 700;") 제목
                                        v-text-field(label='Title', hide-details, single-line, full-width)
                                    v-card-text.pa-0
                                        v-divider
                                    v-card-text.py-1.no-padding-text-field
                                        //span.headline.red--text.text--darken-1(style="font-weight: 700;") 내용
                                        v-textarea(v-model='content', label='Content', full-width, single-line, hide-details, auto-grow)
                                    v-card-text.pa-0
                                        v-divider
                                    v-card-text.py-2.mt-4
                                        span.headline.red--text.text--darken-1(style="font-weight: 700;") 설계도
                                        v-card.my-3.elevation-6(height="250px")
                                    v-card-text.py-2.mt-4
                                        span.headline.red--text.text--darken-1(style="font-weight: 700;") Capability
                                        v-layout.mt-2(row, wrap, justify-center, align-center)
                                            //v-layout(xs12, wrap)
                                                //v-flex(v-for='capability in capabilities', d-inline-flex)
                                            template(v-for="(capa, index) in capabilities", :key="index")
                                                v-badge.mr-3.mb-3.animation-fade-in(overlap='', color='red darken-1')
                                                    v-icon(slot='badge', dark='', small='', @click="removeCapability(index)") close
                                                    v-card.elevation-4.dal-small-card(hover, raised, :width="100")
                                                        v-card-media.white--text(height='75px', :src='"/images/capabilities/" + capa.component + ".png"')
                                                        v-card-text.py-1.text-xs-center {{ capa.title }} {{ index }}

                                            v-card.mr-3.mb-3.elevation-4.dal-small-card(hover, raised, :width="90", :height="90")
                                                v-layout(row, wrap, justify-center, align-center, style="height: 100%;", @click="addCapability()")
                                                    .display-2(style="font-weight: 100;") +


                                    v-card-text.py-2.mt-4
                                        span.headline.red--text.text--darken-1(style="font-weight: 700;") Products
                                        v-layout.mt-2(row, wrap, justify-center, align-center)
                                            template(v-for="(product, index) in products", :key="index")
                                                v-badge.mr-3.mb-3.animation-fade-in(overlap='', color='red darken-1')
                                                    v-icon(slot='badge', dark='', small='', @click="removeProduct(index)") close
                                                    v-card.elevation-4.dal-small-card(hover, raised)
                                                        v-layout(wrap,  style="height: 100%; overflow: hidden; min-height: 80px;")
                                                            v-flex.platform-gradient-background(style="width: 90px;", justify-center, align-center, d-inline-flex)
                                                                img.png-shadow(:src="product.img", style="max-width: 75%; max-height: 75%; border-radius: 10px;")
                                                            v-flex.pa-2(style="width: 180px;")
                                                                v-card-text.pa-0.title {{product.title}}
                                                                v-card-text.py-2.px-0.grey--text.text--darken-1 {{product.company}}
                                                                v-card-text.pa-0.light-blue--text.text--darken-3 Detail

                                            v-card.mr-3.mb-3.elevation-4.dal-small-card(hover, raised, :width="90", :height="90")
                                                v-layout(row, wrap, justify-center, align-center, style="height: 100%;", @click="resetProductForm()")
                                                    .display-2(style="font-weight: 100;") +


                                    v-card-text.py-2.mt-4
                                        span.headline.red--text.text--darken-1(style="font-weight: 700;") Platforms
                                        v-layout.mt-2(row, wrap, justify-center, align-center)
                                            template(v-for="(platform, index) in platforms", :key="index")
                                                v-badge.mr-3.mb-3.animation-fade-in(overlap='', color='red darken-1')
                                                    v-icon(slot='badge', dark='', small='', @click="removePlatform(index)") close
                                                    v-card.elevation-4.dal-small-card(hover, raised)
                                                        v-layout(wrap,  style="height: 100%; overflow: hidden; min-height: 80px;")
                                                            v-flex.platform-gradient-background(style="width: 90px;", justify-center, align-center, d-inline-flex)
                                                                img.png-shadow(:src="platform.logo", style="max-width: 80%; max-height: 80%;")
                                                            v-flex.pa-2(style="width: 180px;")
                                                                v-card-text.pa-0.title {{platform.title}}
                                                                v-card-text.py-2.px-0.grey--text.text--darken-1 {{platform.company}}
                                                                v-card-text.pa-0.grey--text.text--darken-1 {{platform.cost}}

                                            v-card.mr-3.mb-3.elevation-4.dal-small-card(hover, raised, :width="90", :height="90")
                                                v-layout(row, wrap, justify-center, align-center, style="height: 100%;", @click="addPlatform()")
                                                    .display-2(style="font-weight: 100;") +


                                    v-card-text.py-2.mt-4
                                        v-layout(align-center)
                                            v-flex.text-xs-center
                                                v-btn(color="grey", dark) 취소
                                                v-btn(color="red darken-1", dark) 등록

    v-dialog.md6(v-model='addProductDialog', scrollable, max-width='500px')
        v-form(ref="product_form", style="width: 100%;")
            v-card(v-if="tempProduct !== null")
                v-card-title.title Add Product
                    //span.headline Login
                v-divider.py-0.my-0
                v-card-text.py-2.mt-3
                    span.headline.red--text.text--darken-1(style="font-weight: 700;") URL
                    v-text-field(v-model='tempProduct.url', ref="product_url", color="green darken-1", :rules="[supporter.rules.url]", :loading="tempProduct.parsingProgress", :disabled="tempProduct.parsingProgress", append-outer-icon="send", clear-icon='cancel', clearable, label='Product URL', type='url', @click:append-outer='parsingURL()', @click:clear='tempProduct.url=""')

                v-divider.py-0.my-0
                v-card-text.py-2(v-if="tempProduct.parsingComplete")
                    v-layout(row, wrap)
                        v-card-text.py-2.mt-3.px-0
                            span.headline.red--text.text--darken-1(style="font-weight: 700;") Title
                            v-text-field(v-model='tempProduct.title', ref="product_title", color="green darken-1", required, :rules="[supporter.rules.required]", :disabled="tempProduct.parsingProgress", clear-icon='cancel', clearable, label='Product Title', type='text', @click:clear='tempProduct.title=""')

                        v-card-text.py-2.mt-3.px-0
                            span.headline.red--text.text--darken-1(style="font-weight: 700;") Description
                            v-textarea(v-model='tempProduct.description', ref="product_description", color="green darken-1", :disabled="tempProduct.parsingProgress", label='Product Description', rows="1", hide-details, outline, single-line, auto-grow, clear-icon='cancel', clearable, @click:clear='tempProduct.description=""')

                        v-card-text.py-2.mt-3.px-0
                            span.headline.red--text.text--darken-1(style="font-weight: 700;") Company
                            v-text-field(v-model='tempProduct.company', ref="product_company", color="green darken-1", required, :rules="[supporter.rules.required]", :disabled="tempProduct.parsingProgress", clear-icon='cancel', clearable, label='Company', type='text', @click:clear='tempProduct.company=""')

                        v-card-text.py-2.mt-3.px-0
                            span.headline.red--text.text--darken-1(style="font-weight: 700;") Image
                            v-layout(row, wrap, align-center, justify-center)
                                //v-flex(xs12, v-if="tempProduct.img !== null", justify-center, d-inline-flex)
                                img(v-if="tempProduct.img !== null", :src="tempProduct.img", style="max-width: 80%; max-height: 200px;")
                                v-flex.text-xs-center(xs12)
                                    v-btn(flat, color="green darken-1", @click="chooseProductImageDialog = true;")
                                        span(v-if="tempProduct.img === null") Select Image
                                        span(v-else) Change Image
                                //v-card(flat, tile, v-if="tempProduct.img !== null")
                                //    v-card-media(:src='tempProduct.img', height='150px')




                v-card-text.py-4.text-xs-center(v-else) Please input product url.

                v-divider.py-0.my-0

                v-card-actions
                    v-btn(color='error', flat, @click.native="resetProductForm()") Clear
                    v-spacer
                    v-btn(color='success', flat, @click.native="addProduct()") 추가

    v-dialog.md6(v-model='chooseProductImageDialog', scrollable, max-width='480px')
        v-card
            v-card-title.title Select Image
                //span.headline Login
            v-divider.py-0.my-0
            v-card-text.pa-2.brown.lighten-5(v-if="tempProduct !== null && tempProduct.imgs.length > 0")
                v-container.pa-0(v-bind='{ ["grid-list-sm"]: true }', fluid)
                    v-layout(row, wrap)
                        v-flex(v-for='(img, index) in tempProduct.imgs', :key='index', xs4='', @click="chooseProductImage(index)")
                            v-card(flat, tile, style="background: transparent;")
                                v-card-media(:src='img', height='150px')
            v-card-text.py-4.text-xs-center(v-else) There are no image.

            v-divider.py-0.my-0

            v-card-actions
                v-btn(color='error', flat, @click="chooseProductImageDialog = false;") Close


    include footer
    include bottom_tab

    script(type="text/javascript" src='/javascripts/regist-config.js')
    script.
        const vue = init('!{user}');